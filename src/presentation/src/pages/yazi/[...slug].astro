---
import PostPage from "~/presentation/src/pages/_components/posts/post-page.astro";
import { useI18nStatic } from "~/presentation/src/shared/hooks/useI18n";
import { getCollection } from "astro:content";
import StringExtensions from "~/core/acore-ts/data/string/StringExtensions";

const { currentLocale } = useI18nStatic(Astro.url);

export async function getStaticPaths(locale?: string) {
  const posts = await getCollection(
    "posts",
    (postEntry) => !postEntry.data.draft && postEntry.id.endsWith(locale ?? currentLocale),
  );
  return posts.map((post) => ({ params: { slug: StringExtensions.slugify(post.data.title) } }));
}
---

<PostPage />
